<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VANTIEN PORTFOLIO</title>
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap&subset=vietnamese" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/glightbox/dist/css/glightbox.min.css" rel="stylesheet">

<style>
body {
  background-color: #212529;
  color: #fff;
  font-family: 'Poppins', sans-serif;
  overflow-x: hidden;
}

/* --- CARD DỰ ÁN (thumbnail hiển thị ở trang chính) --- */
.project-card { 
  position: relative; 
  overflow: hidden; 
  border-radius: 10px; 
  cursor: pointer; 
  transition: transform 0.3s ease; 
}
.project-img { 
  width: 100%; 
  transition: transform 0.4s ease, filter 0.4s ease; 
}
.project-card:hover .project-img { 
  transform: scale(1.05); 
  filter: brightness(50%); 
}
.project-overlay { 
  position: absolute; 
  top: 50%; left: 50%; 
  transform: translate(-50%, -50%); 
  color: #fff; text-align: center; 
  opacity: 0; 
  transition: opacity 0.3s ease; 
}
.project-card:hover .project-overlay { opacity: 1; }
.project-overlay h4 { font-weight: 600; margin-bottom: 0.25rem; }
.project-overlay p { margin: 0; font-size: 0.9rem; }

/* --- POPUP TỔNG (hiển thị khi click vào project) --- */
.project-popup { 
  position: fixed; 
  top: 0; left: 0; 
  width: 100vw; height: 100vh; 
  background: rgba(0,0,0,0.85); 
  display: flex; 
  justify-content: center; 
  align-items: center; 
  z-index: 9999; 
}

/* --- PHẦN NỘI DUNG POPUP --- */
.popup-content { 
  background: #111; 
  color: #fff; 
  width: 90%; 
  max-width: 1200px; 
  border-radius: 12px; 
  overflow: hidden; 
  padding: 1rem; 
  overflow-y: auto; 
  max-height: 90vh; 
  position: relative; 
}
/* Ẩn thanh cuộn ngang */
.popup-content::-webkit-scrollbar { display: none; }

.close-btn { 
  position: absolute; 
  top: 1rem; right: 1rem; 
  font-size: 2rem; 
  color: white; 
  cursor: pointer; 
  z-index: 10; 
}

.popup-title { font-weight: 600; margin-bottom: 0.3rem; }
.popup-desc { font-size: 0.95rem; color: #ccc; margin-bottom: 1rem; }

/* --- VIDEO (trên cùng popup) --- */
.popup-video { width: 100%; aspect-ratio: 16/9; margin-bottom: 1rem; }
.popup-video iframe { width: 100%; height: 100%; border-radius: 8px; }

/* --- ẢNH FULL (ngang bằng video, full chiều ngang) --- */
.popup-full-container img {
  width: 100%;
  height: auto;
  object-fit: contain;
  border-radius: 8px;
  display: block;
  margin-bottom: 1rem;
}

/* --- GRID ẢNH (3 ảnh 1 hàng, tự xuống hàng nếu dư) --- */
.image-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
  margin-top: 1rem;
}
.image-grid img {
  width: 100%;
  height: auto;
  border-radius: 6px;
  object-fit: cover;
  cursor: pointer;
  transition: transform 0.3s ease;
}

/* --- WRAPPER bao từng block ảnh full hoặc grid --- */
.element-wrapper { margin-top: 16px; }
.element-wrapper img {
  width: 100%;
  border-radius: 10px;
  display: block;
  height: auto;
}

/* --- GRID 3 CỘT cho nhóm ảnh nhỏ --- */
.photo-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr); /* chỉnh số cột ở đây nếu muốn */
  gap: 10px;
  margin-top: 16px;
}
.photo-grid img {
  width: 100%;
  border-radius: 8px;
  height: auto;
  object-fit: cover;
}
</style>
</head>
<body>

<section id="Projects" class="container-fluid py-5 text-center">
  <h1 class="font-weight-bold mb-4">My Projects</h1>

  <div class="row justify-content-center">

    <!-- === PROJECT CARD (ví dụ 1) === -->
    <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12 mb-2 px-1">
      <div class="project-card"
           data-title="Brand Identity"
           data-desc="Visual branding & design system"
           data-video="https://www.youtube.com/embed/dQw4w9WgXcQ"
		   data-images="
        	images/BrandGuidelines_ANTKEY-18.jpg,
        	images/BrandGuidelines_ANTKEY-18.jpg,images/BrandGuidelines_ANTKEY-18.jpg,images/BrandGuidelines_ANTKEY-18.jpg,
        	images/BrandGuidelines_ANTKEY-18.jpg,
        	images/BrandGuidelines_ANTKEY-18.jpg,
        	images/BrandGuidelines_ANTKEY-18.jpg,images/BrandGuidelines_ANTKEY-18.jpg,images/BrandGuidelines_ANTKEY-18.jpg,images/BrandGuidelines_ANTKEY-18.jpg,images/BrandGuidelines_ANTKEY-18.jpg,images/BrandGuidelines_ANTKEY-18.jpg,images/BrandGuidelines_ANTKEY-18.jpg"
      	   data-layouts="full,grid,grid,grid,full,full,grid,grid,grid,grid,grid,grid,grid">
           <!-- data-images: chứa toàn bộ ảnh (full + grid) theo thứ tự muốn hiển thị -->
           <!-- data-layouts: tương ứng từng ảnh (full hoặc grid) -->
           
        <img src="images/BrandGuidelines_ANTKEY-18.jpg" class="project-img" alt="Project 1">
        <div class="project-overlay">
          <h4>Brand Identity</h4>
          <p>Visual branding & design system</p>
        </div>
      </div>
    </div>

    <!-- (các project-card khác giữ nguyên cấu trúc tương tự) -->
    <!-- Chỉ cần thay data-images và data-layouts cho từng project -->
  </div>
</section>

<!-- === POPUP HIỂN THỊ CHI TIẾT PROJECT === -->
<div id="projectPopup" class="project-popup" style="display:none;">
  <div class="popup-content">
    <span class="close-btn">&times;</span>
    <h3 class="popup-title"></h3>
    <p class="popup-desc"></p>
    <div class="popup-video" id="popupVideoContainer"></div>
    <div id="popupMainImageContainer"></div> <!-- chứa ảnh full và grid -->
    <div class="image-grid" id="popupGridImagesContainer"></div>
  </div>
</div>

<!-- === SCRIPT === -->
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/glightbox/dist/js/glightbox.min.js"></script>
<script>
$(document).ready(function() {
  let lightbox = null; // khai báo lightbox (để xem ảnh khi click)

  /* --- HÀM ĐÓNG POPUP --- */
  function closePopup() {
    $("#projectPopup").fadeOut(200);
    $("body").css("overflow", "auto");

    // hủy lightbox cũ nếu có
    if (lightbox) {
      try { lightbox.destroy(); } catch (e) {}
      lightbox = null;
    }

    // reset nội dung popup
    $("#popupVideoContainer").html("");
    $("#popupMainImageContainer").html("");
    $("#popupGridImagesContainer").html("");
  }

  /* --- CLICK MỞ POPUP --- */
  $(".project-card").on("click", function() {
    const title = $(this).data("title");
    const desc = $(this).data("desc");
    const videoURL = $(this).data("video");

    $(".popup-title").text(title || "");
    $(".popup-desc").text(desc || "");

    // === VIDEO ===
    if (videoURL) {
      let src = videoURL;
      const m = videoURL.match(/(?:watch\?v=|youtu\.be\/)([\w-]+)/);
      if (m && !videoURL.includes('embed')) src = 'https://www.youtube.com/embed/' + m[1];
      $("#popupVideoContainer").html(`<iframe src="${src}" frameborder="0" allowfullscreen loading="lazy"></iframe>`).show();
    } else {
      $("#popupVideoContainer").hide();
    }

    // === XỬ LÝ ẢNH (FULL + GRID) ===
    $("#popupMainImageContainer").html("");
    const allImages = [];

    // --- Nếu dùng data-images + data-layouts ---
    if ($(this).data("images")) {
      const imgs = String($(this).data("images")).split(",").map(s => s.trim()).filter(Boolean);
      const layouts = String($(this).data("layouts") || "").split(",").map(s => s.trim());
      imgs.forEach((src, idx) => {
        const type = layouts[idx] || "grid"; // nếu thiếu layout → mặc định grid
        allImages.push({ src, type });
      });
    }

    const galleryId = 'g_' + Date.now(); // ID duy nhất cho glightbox
    let currentGrid = null; // tạm giữ nhóm ảnh grid

    // --- Duyệt toàn bộ ảnh theo thứ tự ---
    allImages.forEach(img => {
      if (img.type === "full") {
        // Nếu đang có nhóm grid → đóng nhóm cũ lại
        if (currentGrid) {
          $("#popupMainImageContainer").append(currentGrid);
          currentGrid = null;
        }

        // Ảnh full (chiếm full chiều ngang)
        $("#popupMainImageContainer").append(`
          <div class="popup-full-container element-wrapper">
            <img src="${img.src}" alt="">
          </div>
        `);
      } else {
        // Ảnh grid (3 ảnh mỗi hàng)
        if (!currentGrid) currentGrid = $('<div class="photo-grid"></div>');
        currentGrid.append(`<a href="${img.src}" class="glightbox" data-gallery="${galleryId}"><img src="${img.src}" alt=""></a>`);
      }
    });

    // Nếu nhóm grid cuối cùng chưa được thêm → thêm vào DOM
    if (currentGrid) $("#popupMainImageContainer").append(currentGrid);

    // --- Kích hoạt glightbox cho nhóm ảnh ---
    if (lightbox) {
      try { lightbox.destroy(); } catch (e) {}
      lightbox = null;
    }
    setTimeout(() => {
      lightbox = GLightbox({ selector: 'a.glightbox[data-gallery="' + galleryId + '"]' });
    }, 50);

    // --- Hiển thị popup ---
    $("#projectPopup").fadeIn(200);
    $("body").css("overflow", "hidden");
  });

  /* --- ĐÓNG POPUP (click hoặc ESC) --- */
  $(".close-btn").on("click", closePopup);
  $("#projectPopup").on("click", function(e) {
    if ($(e.target).is("#projectPopup")) closePopup();
  });
  $(document).on("keydown", function(e) {
    if (e.key === "Escape") closePopup();
  });
});
</script>

</body>
</html>
